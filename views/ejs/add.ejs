<%- include("head") %>
<%- include("headContent") %>
<% var config = adminpanel.configHelper.getConfig() %>

<div class="content__body">
    <div class="flex gap-3 mt-4">
        <% var actionType = 'add' %>
        <%- include("mixin/globalActions", {actionType: actionType}) %>
    </div>
    <div class="flex gap-3">
        <a href="<%= entity.uri %>/">
            <button class="btn btn-back">
                <i class="las la-long-arrow-alt-left"></i>
                <%= __("Back") %>
            </button>
        </a>
    </div>

    <form id="form" action="<%= entity.uri %>/add" method="POST" enctype="multipart/form-data">

        <%# global variables %>
        <script>
			var jsonEditor = {};
			var aceCounter = 0;
			let editor = [];
			let textarea = [];
			var tables = {};
        </script>
        <div class="mt-14 flex flex-col gap-10 max-w-[1144px]">
            <% Object.keys(fields).forEach(function(key) { %>
                <% if ((!config.showORMtime) && (key === 'createdAt' || key === 'updatedAt')) return %>
                <div class="flex flex-col gap-3">
                    <div class="admin-panel__wrapper-title">
                        <label class="admin-panel__title"
                               for="form-<%= key %>"><%= __(fields[key].config.title) %></label>
                        <% if(fields[key].config.tooltip) { %>
                            <div class="tooltip tooltip-right group cursor-pointer">
                                <i class="las la-info-circle text-blue-400"></i>
                                <div class="tooltip__content group-hover:visible group-hover:opacity-100">
                                    <span><%= __(fields[key].config.tooltip) %></span>
                                </div>
                            </div>
                        <% } %>
                    </div>
                    <% var field = fields[key] %>
                    <% var value = data[key] %>
                    <% if (field.config.description) { %>
                        <div class="admin-panel__description">
                            <%- __(field.config.description) %>
                        </div>
                    <% } %>
                    <div class="admin-panel__widget">
                        <%- include("mixin/fieldWidget", {field: field, value: value, key: key}) %>
                    </div>
                </div>
            <% }) %>
            <% if (adminpanel.configHelper.isCsrfEnabled()) { %>
                <div>
                    <input class="clr-input" type="hidden" name="_csrf" value="<%= _csrf %>"/>
                </div>
            <% } %>
                <span id="error-btn-submit-text" style="display: none"><b>One or more fields are filled in incorrectly</b></span>
            <p>
                <button class="btn btn-green" id="submit" onclick="submitForm()">
                    <%= __("Save") %>
                </button>
            </p>
        </div>
    </form>
</div>

<%- include("footer") %>
